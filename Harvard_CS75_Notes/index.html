<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/><meta content="telephone=no" name="format-detection"/><meta name="description"/><title>Notes for Harvard CS75 Web Development Lecture 9 Scalability by David Malan | Nine notes</title><link rel="stylesheet" type="text/css" href="/blog//css/normalize.css"/><link rel="stylesheet" type="text/css" href="/blog//css/pure-min.css"/><link rel="stylesheet" type="text/css" href="/blog//css/grids-responsive-min.css"/><link rel="stylesheet" type="text/css" href="/blog//css/style.css"/><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"/><link rel="alternate" type="application/atom+xml" href="/atom.xml"/></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Notes for Harvard CS75 Web Development Lecture 9 Scalability by David Malan</h1><a id="logo" href="/blog/">Nine notes</a><p class="description">Live long and prosper</p></div><div id="nav-menu"><a href="/" class="current"><i class="icon-home"> Home</i></a><a href="/blog/archives/"><i class="icon-archive"> Archive</i></a><a href="/blog/about/"><i class="icon-about"> About</i></a><a href="/blog/atom.xml"><i class="icon-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">Notes for Harvard CS75 Web Development Lecture 9 Scalability by David Malan</h1><div class="post-meta">2016-01-16 | <span class="categories">Categorized in<a href="/blog/categories/System-Design/"> System Design</a></span></div><div class="post-content"><p><a href="https://www.youtube.com/watch?v=-W9F__D3oY4&amp;list=WL&amp;index=1" target="_blank" rel="external">Lecture 9 video</a></p>
<h2 id="Web_Hosts"><a href="#Web_Hosts" class="headerlink" title="Web Hosts"></a>Web Hosts</h2><p>Features: </p>
<ul>
<li>Is IP address blocked in some countries/regions?</li>
<li>SFTP vs. FTP. SFTP is secure and all the traffic is encrypted, which is important for user names and passwords</li>
<li>Some hosting companies may offer you some unbelievable features, like unlimited storage spac, at a very low price. It’s very likely that you and another hundreds users are sharing the same machine and contending for resources. This is because sometime people actually don’t need that many resources.</li>
<li>Virtual private server. May still share one machine with other users, but you have your own copy of the operating system. Run multiple virtual machine on a physical machine. Only you and the system administrators have access to your files</li>
<li>If you want more privacy, then probably you have to operate your own servers</li>
</ul>
<p>AWS EC2</p>
<h2 id="How_to_scale"><a href="#How_to_scale" class="headerlink" title="How to scale"></a>How to scale</h2><h3 id="Vertical_Scaling"><a href="#Vertical_Scaling" class="headerlink" title="Vertical Scaling"></a>Vertical Scaling</h3><p>Get more RAM, processors, disks,…, for one machine, but you will exhaust the financial resources/state of arts technology.</p>
<h3 id="Horizontal_Scaling"><a href="#Horizontal_Scaling" class="headerlink" title="Horizontal Scaling"></a>Horizontal Scaling</h3><p>Plural number of machines, use multiple servers to build the topology.</p>
<h4 id="Load_Balancer"><a href="#Load_Balancer" class="headerlink" title="Load Balancer"></a>Load Balancer</h4><p>Need to distriubte inbound HTTP requests</p>
<p>Return the public IP address of the load balancer, and let the load balancer determin how to actually route data to the backend server (private address).</p>
<p><strong>Implementation</strong></p>
<ul>
<li>Dedicated servers for gifs, jpegs, images, videos, etc for different host HTTP header</li>
<li>Round robin. Or, the load balancer can be a DNS setup which returns the IP address of server 1 when the first time someone asks for a url, then return the IP address of server 2 when the second time someone asks for the same url, then server 3, server 4,…, eventually wrapping up. Downside: one server may get a really computational heavy user; </li>
<li>Based on the load on a server</li>
<li>Have a server specifically for storing sessions. But what if that machine breaks down. Lacks redundacy. Can add RAID (redundant array of independent disks), striping and redundancy</li>
</ul>
<p>When we type the url in the browser and hit enter, the OS will send a packet to DNS server which will translate host names to IPs and vice versa. If we click a link on a website, there is a cache to store the IP address so the OS doesn’t have to send the same DNS request again. Both OS and browser have a cache. Time to Live (TTL) values associated with an answer from a DNS server, 5 minutes, 1 hour, or 1 day. Global load balancing…</p>
<p>If the backend is PHP based and the session in PHP is broken. And if you were on Server 1, then by chance you are sent to Server 2 by a round-robin, you might have to log in again. Or think about shopping cart.</p>
<p><strong>Stick sessions </strong>(when you visit a website multiple times your session is somehow preserve even if there are multiple backend servers)</p>
<p><strong>Cookies</strong>:<br>Can store the address of the server so the next the user visit the website, he goes to the same back-end server. Downside: the private IP of the back-end server may change; the private IP is now visible to the whole world</p>
<p>==&gt;</p>
<p>Store a random number and let the load balancer remember which number belongs to which server</p>
<ul>
<li>Software<ul>
<li>ELB</li>
<li>HAProxy</li>
<li>LVS</li>
</ul>
</li>
<li>Hardware<ul>
<li>Barracuda</li>
<li>Cisco</li>
<li>Citrix</li>
<li>F5      </li>
</ul>
</li>
</ul>
<p>PHP Acceleration<br>php.exe compiles php everytime but throws away the result. Some software can keep the result. Like .py vs. .pyc.</p>
<p>Caching</p>
<ul>
<li>.html vs. MySQL database/XML (avoid regenerating) more performance vs. more space. But requires a lot of work when want to update/redesign the page</li>
<li>MySQL query cache: query_cache_type: 1</li>
<li>memchached: store whatever you want in RAM (garbage collection: expire objects based on when they are put in)</li>
</ul>
<h4 id="Replication_3A"><a href="#Replication_3A" class="headerlink" title="Replication:"></a>Replication:</h4><p><strong>Master-Slave</strong></p>
<p>Master: the main database that you write/read data to/from.<br>Slave: anytime a query is executed on the<br>master that same query is copied down to one or more slaves and they do the exact same thing </p>
<p>Advantages: </p>
<ul>
<li>If the master is down, promote one of the slaves and do some configuration. (redundacy) </li>
<li>If there are a lot queries, you could just load balance across database servers</li>
<li>For read heavy websites, any select can go to all four databases, while any insert/update/delete has to go to server master</li>
</ul>
<p><strong>Mastter-Master</strong></p>
<p>you could write to either server one or two and if you happen to write to server1 that query gets replicated on server2 and vice versa so now you could keep it simple</p>
<h4 id="Load_balancing_+_Replication"><a href="#Load_balancing_+_Replication" class="headerlink" title="Load balancing + Replication"></a>Load balancing + Replication</h4><p>active + active pair of load balancers<br>active + passive pair of load balancers, passive promote itself when receives no more packets from the active one.<br>and send packets to each other </p>
<p><strong>Partitioning</strong><br>A-M cluster and O-Z cluster</p>
<p><strong>High Availability</strong><br>One load balancer, two master replicating each other</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Internet ==(TCP <span class="number">443</span> <span class="number">80</span>)=<span class="function">=&gt;</span> </span><br><span class="line">two load balancers ==(TCP <span class="number">80</span>)=<span class="function">=&gt;</span> </span><br><span class="line">web servers ==x=<span class="function">=&gt;</span> </span><br><span class="line">two load balancers ==x (TCP <span class="number">3306</span>)=<span class="function">=&gt;</span> </span><br><span class="line">two &lt;==X=<span class="function">=&gt;</span>  master databases </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Fire wall <span class="literal">on</span> <span class="keyword">switch</span> ports</span><br></pre></td></tr></table></figure></div><div class="tags"><a href="/blog/tags/System-Design/">System Design</a><a href="/blog/tags/Web/">Web</a></div><div class="post-nav"><a href="/blog/3D_Array_Size/" class="pre"><i class="icon-previous">3D Array Size</i></a><a href="/blog/Power_of_Three/" class="next">Power of Three<i class="icon-next"></i></a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search" class="search-form-input"/><input type="hidden" name="sitesearch" value="ninefu.github.io/blog"/></form></div><div class="widget"><div class="widget-title">Categories</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Interview/">Interview</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Leetcode/">Leetcode</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/System-Design/">System Design</a></li></ul></div><div class="widget"><div class="widget-title">Tags</div><div class="tagcloud"><a href="/blog/tags/Bit/" style="font-size: 15px;">Bit</a> <a href="/blog/tags/Technical-Interview/" style="font-size: 15px;">Technical Interview</a> <a href="/blog/tags/String/" style="font-size: 15px;">String</a> <a href="/blog/tags/System-Design/" style="font-size: 15px;">System Design</a> <a href="/blog/tags/Stack/" style="font-size: 15px;">Stack</a> <a href="/blog/tags/Hash/" style="font-size: 15px;">Hash</a> <a href="/blog/tags/Sort/" style="font-size: 15px;">Sort</a> <a href="/blog/tags/Design/" style="font-size: 15px;">Design</a> <a href="/blog/tags/Array/" style="font-size: 15px;">Array</a> <a href="/blog/tags/Reading-List/" style="font-size: 15px;">Reading List</a> <a href="/blog/tags/Math/" style="font-size: 15px;">Math</a> <a href="/blog/tags/Leetcode/" style="font-size: 15px;">Leetcode</a> <a href="/blog/tags/Tree/" style="font-size: 15px;">Tree</a> <a href="/blog/tags/DFS/" style="font-size: 15px;">DFS</a> <a href="/blog/tags/Linked-List/" style="font-size: 15px;">Linked List</a> <a href="/blog/tags/Two-Pointers/" style="font-size: 15px;">Two Pointers</a> <a href="/blog/tags/Dynamic-Programming/" style="font-size: 15px;">Dynamic Programming</a> <a href="/blog/tags/Backtracking/" style="font-size: 15px;">Backtracking</a> <a href="/blog/tags/Divide-and-Conquer/" style="font-size: 15px;">Divide and Conquer</a> <a href="/blog/tags/Binary-Search/" style="font-size: 15px;">Binary Search</a> <a href="/blog/tags/Hashtable/" style="font-size: 15px;">Hashtable</a> <a href="/blog/tags/TODO/" style="font-size: 15px;">TODO</a> <a href="/blog/tags/Web/" style="font-size: 15px;">Web</a></div></div><div class="widget"><div class="widget-title">Recent</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/Regular/">Regular Expression Matching</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/ZigZag_Conversion/">ZigZag</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/WeChat/">How to Design the Backend of WeChat</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/Remove_Duplicates_from_Sorted_Array_II/">Remove Duplicates From Sorted Array II</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/Remove_Duplicates_from_Sorted_Array/">Remove Duplicates From Sorted Array</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/Java_Interview_Questions/">Java Interview Questions</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/System_Design_Reading_List/">System Design Reading List</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/Dice_Game_Probability/">Dice Game Probability</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/3D_Array_Size/">3D Array Size</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/Harvard_CS75_Notes/">Notes for Harvard CS75 Web Development Lecture 9 Scalability by David Malan</a></li></ul></div><div class="widget"><div class="widget-title">Blogroll</div></div></div></div></div><div id="footer">© <a href="/" rel="nofollow">Nine notes.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script src="/blog//js/jquery.min.js" type="text/javascript"></script>
<script src="/blog//js/totop.js" type="text/javascript"></script><script src="/blog//js/fancybox.pack.js" type="text/javascript"></script>
<script src="/blog//js/jquery.fancybox.js" type="text/javascript"></script><link rel="stylesheet" href="/blog//css/jquery.fancybox.css" type="text/css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-71661570-1','auto');ga('send','pageview');
</script></div></body></html>